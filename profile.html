    <!DOCTYPE html><html>
    <head>

        <meta charset="UTF-8">
        <title>Orwell</title>
        <link rel="stylesheet" href="style.css">


        <style>
           
            h1 {
            justify-content: center;
            align-items: center;
            color: #db552c;
        font-family:Verdana, Geneva, Tahoma, sans-serif}

            
            button {
                margin-top: 30px;
            }
        

        </style>
    </head>
    <body>
     
          
      <nav>
    <h1 id ="nameApp">Orwell</h1>
    <a href="index.html">Home</a><br><br>
    <a href="logIn.html">back to log in</a><br><br>
    <a href="profile.html">view profile</a><br><br>
    <a href="about.html">about</a>
    <!-- add more links as needed -->
  </nav>

    <div class="main-content">

    
        <h1 id="welcome"></h1>
          
        <p id="message"></p>

        <div class="stats-container">

        <div id="streak">
            <h3><strong>STREAK ðŸ”¥</strong></h3> 
            <h2> ### </h2>
        </div>


        <div id="quiztracker">
            <h3><strong>quiz tracker !!!!</strong></h3>
            <h2> ### </h2>
        </div>

        <div id="currentLevel">
            <h3><strong> Current Level!</strong></h2>
            <h2> Policy Enthusiast </h2>
        </div>

        </div>
        
        
        <button id="logout">logout</button>
   

        </div>

        <script type="module">
            import { initializeApp} from "https://www.gstatic.com/firebasejs/10.5.0/firebase-app.js";
            import { getDatabase, ref, get } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-database.js";
            import {child, update } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-database.js";
            let currentUser = "";
            
        const firebaseConfig = {
        apiKey: "AIzaSyCS07UgX2GnmuufEQET-RYOtm8i0XaZkWk",
        authDomain: "orwell-ea558.firebaseapp.com",
        databaseURL: "https://orwell-ea558-default-rtdb.firebaseio.com",
        projectId: "orwell-ea558",
        storageBucket: "orwell-ea558.firebasestorage.app",
        messagingSenderId: "301391502605",
        appId: "1:301391502605:web:67c58902e72044cd03a444"
        };
            const app = initializeApp(firebaseConfig);
            const db = getDatabase(app);

            const logout = document.getElementById('logout');
            const message = document.getElementById('message');
            const welcome = document.getElementById('welcome');

    async function loadActiveUser() {
    try {
        const snapshot = await get(child(ref(db), 'users'));

        if (snapshot.exists()) {
        const users = snapshot.val();

        for(const key in users){
            if (users[key].active === true){
                currentUser = users[key].name; 
                break;  // once found, no need to continue
            } 
        }
        }

        welcome.textContent = currentUser ? `Hello ${currentUser}!` : "Welcome!";

    } catch (error) {
        console.error(error);
        welcome.textContent = "Welcome!";
    }
    }

    loadActiveUser();



            logout.addEventListener('click', async(e)=>{
                e.preventDefault();

                try {
                const snapshot = await get(child(ref(db), 'users'));

                if (snapshot.exists()) {
                const users = snapshot.val();

                for (const key in users) {
                    if (
                    users[key].active === true
                    ) {
                    await update(ref(db, `users/${key}`), { active: false });


                    message.textContent = "Logout successful!";
                    message.style.color = "green";
                    setTimeout(() => {
                window.location.href = 'signIn.html'}, 1000);
                    break;
                    }  
                }
            }} catch (error) {
                console.error(error);
                message.textContent = "Error connecting to database.";
                message.style.color = "orange";
            }

        })


        //later add Welcome _______ account name. ???? how to search for specific account name with logged in id??

        </script>



    </body>

    </html>